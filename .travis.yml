language: java
jdk: oraclejdk8
if: tag IS blank
before_install:
 - git checkout -b master
 - git checkout $TRAVIS_BRANCH
install: 
 - ./gradlew setupCiWorkspace
script: 
 - |
    if [ "$TRAVIS_PULL_REQUEST" == false ]; then
      if [ "$TRAVIS_BRANCH" == "release/1.12" ]; then
        ./gradlew build makeChangelog curseforge299755 githubRelease
      else
        if [ "$TRAVIS_BRANCH" == "pre-release" ]; then
          ./gradlew build makeChangelog curseforge299755 githubRelease
        else
          if [ "$TRAVIS_BRANCH" == "dev/fabric" ]; then
            ./gradlew build githubRelease --stacktrace
          else
            ./gradlew build githubRelease
          fi
        fi
      fi
    else
      ./gradlew build
    fi

cache:
    directories:
      -/home/travis/.gradle/

notifications:
    slack: wip-name:uZWumWJ6i8idAwHoV0rg1XP2

after_success:
- wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
- chmod +x send.sh
- ./send.sh success $WEBHOOK_URL
after_failure:
- wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
- chmod +x send.sh
- ./send.sh failure $WEBHOOK_URL